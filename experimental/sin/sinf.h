#ifndef __RLIBM_SINF_H__
#define __RLIBM_SINF_H__

#include <stdio.h>
#include <stdint.h>
#include <x86intrin.h>
#include <math.h>

typedef union {
  uint32_t i;
  float f;
} FLT;

typedef union {
  uint64_t i;
  double d;
} DBL;

float rlibm_fast_sin(float);

static const double one_over_pi_28[8] = {
  0x1.45f306cp-2,
  0x1.c9c882ap-30,
  0x1.4fe13a8p-60,
  0x1.f47d4dp-87,
  0x1.bb81b6cp-114,
  0x1.4acc9ep-144,
  0x1.0e4107cp-171,
  0x1.ca2c756p-198
};

static const double one_over_pi_28_exp[8] = {-29, -57, -85, -113, -141, -169, -197, -225};

static const double sinpiMBy512[256] = {
  0x0p+0,
  0x1.921f0fe670071p-8,
  0x1.921d1fcdec784p-7,
  0x1.2d936bbe30efdp-6,
  0x1.92155f7a3667ep-6,
  0x1.f693731d1cf01p-6,
  0x1.2d865759455cdp-5,
  0x1.5fc00d290cd43p-5,
  0x1.91f65f10dd814p-5,
  0x1.c428d12c0d7e3p-5,
  0x1.f656e79f820ep-5,
  0x1.1440134d709b3p-4,
  0x1.2d52092ce19f6p-4,
  0x1.4661179272096p-4,
  0x1.5f6d00a9aa419p-4,
  0x1.787586a5d5b21p-4,
  0x1.917a6bc29b42cp-4,
  0x1.aa7b724495c03p-4,
  0x1.c3785c79ec2d5p-4,
  0x1.dc70ecbae9fc9p-4,
  0x1.f564e56a9730ep-4,
  0x1.072a047ba831dp-3,
  0x1.139f0cedaf577p-3,
  0x1.20116d4ec7bcfp-3,
  0x1.2c8106e8e613ap-3,
  0x1.38edbb0cd8d14p-3,
  0x1.45576b1293e5ap-3,
  0x1.51bdf8597c5f2p-3,
  0x1.5e214448b3fc6p-3,
  0x1.6a81304f64ab2p-3,
  0x1.76dd9de50bf31p-3,
  0x1.83366e89c64c6p-3,
  0x1.8f8b83c69a60bp-3,
  0x1.9bdcbf2dc4366p-3,
  0x1.a82a025b00451p-3,
  0x1.b4732ef3d6722p-3,
  0x1.c0b826a7e4f63p-3,
  0x1.ccf8cb312b286p-3,
  0x1.d934fe5454311p-3,
  0x1.e56ca1e101a1bp-3,
  0x1.f19f97b215f1bp-3,
  0x1.fdcdc1adfedf9p-3,
  0x1.04fb80e37fdaep-2,
  0x1.0b0d9cfdbdb9p-2,
  0x1.111d262b1f677p-2,
  0x1.172a0d7765177p-2,
  0x1.1d3443f4cdb3ep-2,
  0x1.233bbabc3bb71p-2,
  0x1.294062ed59f06p-2,
  0x1.2f422daec0387p-2,
  0x1.35410c2e18152p-2,
  0x1.3b3cefa0414b7p-2,
  0x1.4135c94176601p-2,
  0x1.472b8a5571054p-2,
  0x1.4d1e24278e76ap-2,
  0x1.530d880af3c24p-2,
  0x1.58f9a75ab1fddp-2,
  0x1.5ee27379ea693p-2,
  0x1.64c7ddd3f27c6p-2,
  0x1.6aa9d7dc77e17p-2,
  0x1.7088530fa459fp-2,
  0x1.766340f2418f6p-2,
  0x1.7c3a9311dcce7p-2,
  0x1.820e3b04eaac4p-2,
  0x1.87de2a6aea963p-2,
  0x1.8daa52ec8a4bp-2,
  0x1.9372a63bc93d7p-2,
  0x1.993716141bdffp-2,
  0x1.9ef7943a8ed8ap-2,
  0x1.a4b4127dea1e5p-2,
  0x1.aa6c82b6d3fcap-2,
  0x1.b020d6c7f4009p-2,
  0x1.b5d1009e15ccp-2,
  0x1.bb7cf2304bd01p-2,
  0x1.c1249d8011ee7p-2,
  0x1.c6c7f4997000bp-2,
  0x1.cc66e9931c45ep-2,
  0x1.d2016e8e9db5bp-2,
  0x1.d79775b86e389p-2,
  0x1.dd28f1481cc58p-2,
  0x1.e2b5d3806f63bp-2,
  0x1.e83e0eaf85114p-2,
  0x1.edc1952ef78d6p-2,
  0x1.f3405963fd067p-2,
  0x1.f8ba4dbf89abap-2,
  0x1.fe2f64be7121p-2,
  0x1.01cfc874c3eb7p-1,
  0x1.0485626ae221ap-1,
  0x1.073879922ffeep-1,
  0x1.09e907417c5e1p-1,
  0x1.0c9704d5d898fp-1,
  0x1.0f426bb2a8e7ep-1,
  0x1.11eb3541b4b23p-1,
  0x1.14915af336cebp-1,
  0x1.1734d63dedb49p-1,
  0x1.19d5a09f2b9b8p-1,
  0x1.1c73b39ae68c8p-1,
  0x1.1f0f08bbc861bp-1,
  0x1.21a799933eb59p-1,
  0x1.243d5fb98ac1fp-1,
  0x1.26d054cdd12dfp-1,
  0x1.2960727629ca8p-1,
  0x1.2bedb25faf3eap-1,
  0x1.2e780e3e8ea17p-1,
  0x1.30ff7fce17035p-1,
  0x1.338400d0c8e57p-1,
  0x1.36058b10659f3p-1,
  0x1.3884185dfeb22p-1,
  0x1.3affa292050b9p-1,
  0x1.3d78238c58344p-1,
  0x1.3fed9534556d4p-1,
  0x1.425ff178e6bb1p-1,
  0x1.44cf325091dd6p-1,
  0x1.473b51b987347p-1,
  0x1.49a449b9b0939p-1,
  0x1.4c0a145ec0004p-1,
  0x1.4e6cabbe3e5e9p-1,
  0x1.50cc09f59a09bp-1,
  0x1.5328292a35596p-1,
  0x1.5581038975137p-1,
  0x1.57d69348cecap-1,
  0x1.5a28d2a5d725p-1,
  0x1.5c77bbe65018cp-1,
  0x1.5ec3495837074p-1,
  0x1.610b7551d2cdfp-1,
  0x1.63503a31c1be9p-1,
  0x1.6591925f0783dp-1,
  0x1.67cf78491af1p-1,
  0x1.6a09e667f3bcdp-1,
  0x1.6c40d73c18275p-1,
  0x1.6e74454eaa8afp-1,
  0x1.70a42b3176d7ap-1,
  0x1.72d0837efff96p-1,
  0x1.74f948da8d28dp-1,
  0x1.771e75f037261p-1,
  0x1.79400574f55e5p-1,
  0x1.7b5df226aafafp-1,
  0x1.7d7836cc33db2p-1,
  0x1.7f8ece3571771p-1,
  0x1.81a1b33b57accp-1,
  0x1.83b0e0bff976ep-1,
  0x1.85bc51ae958ccp-1,
  0x1.87c400fba2ebfp-1,
  0x1.89c7e9a4dd4aap-1,
  0x1.8bc806b151741p-1,
  0x1.8dc45331698ccp-1,
  0x1.8fbcca3ef940dp-1,
  0x1.91b166fd49da2p-1,
  0x1.93a22499263fbp-1,
  0x1.958efe48e6dd7p-1,
  0x1.9777ef4c7d742p-1,
  0x1.995cf2ed80d22p-1,
  0x1.9b3e047f38741p-1,
  0x1.9d1b1f5ea80d5p-1,
  0x1.9ef43ef29af94p-1,
  0x1.a0c95eabaf937p-1,
  0x1.a29a7a0462782p-1,
  0x1.a4678c8119ac8p-1,
  0x1.a63091b02fae2p-1,
  0x1.a7f58529fe69dp-1,
  0x1.a9b66290ea1a3p-1,
  0x1.ab7325916c0d4p-1,
  0x1.ad2bc9e21d511p-1,
  0x1.aee04b43c1474p-1,
  0x1.b090a581502p-1,
  0x1.b23cd470013b4p-1,
  0x1.b3e4d3ef55712p-1,
  0x1.b5889fe921405p-1,
  0x1.b728345196e3ep-1,
  0x1.b8c38d27504e9p-1,
  0x1.ba5aa673590d2p-1,
  0x1.bbed7c49380eap-1,
  0x1.bd7c0ac6f952ap-1,
  0x1.bf064e15377ddp-1,
  0x1.c08c426725549p-1,
  0x1.c20de3fa971bp-1,
  0x1.c38b2f180bdb1p-1,
  0x1.c5042012b6907p-1,
  0x1.c678b3488739bp-1,
  0x1.c7e8e52233cf3p-1,
  0x1.c954b213411f5p-1,
  0x1.cabc169a0b9p-1,
  0x1.cc1f0f3fcfc5cp-1,
  0x1.cd7d9898b32f6p-1,
  0x1.ced7af43cc773p-1,
  0x1.d02d4feb2bd92p-1,
  0x1.d17e7743e35dcp-1,
  0x1.d2cb220e0ef9fp-1,
  0x1.d4134d14dc93ap-1,
  0x1.d556f52e93eb1p-1,
  0x1.d696173c9e68bp-1,
  0x1.d7d0b02b8ecf9p-1,
  0x1.d906bcf328d46p-1,
  0x1.da383a9668988p-1,
  0x1.db6526238a09bp-1,
  0x1.dc8d7cb41026p-1,
  0x1.ddb13b6ccc23cp-1,
  0x1.ded05f7de47dap-1,
  0x1.dfeae622dbe2bp-1,
  0x1.e100cca2980acp-1,
  0x1.e212104f686e5p-1,
  0x1.e31eae870ce25p-1,
  0x1.e426a4b2bc17ep-1,
  0x1.e529f04729ffcp-1,
  0x1.e6288ec48e112p-1,
  0x1.e7227db6a9744p-1,
  0x1.e817bab4cd10dp-1,
  0x1.e9084361df7f2p-1,
  0x1.e9f4156c62ddap-1,
  0x1.eadb2e8e7a88ep-1,
  0x1.ebbd8c8df0b74p-1,
  0x1.ec9b2d3c3bf84p-1,
  0x1.ed740e7684963p-1,
  0x1.ee482e25a9dbcp-1,
  0x1.ef178a3e473c2p-1,
  0x1.efe220c0b95ecp-1,
  0x1.f0a7efb9230d7p-1,
  0x1.f168f53f7205dp-1,
  0x1.f2252f7763adap-1,
  0x1.f2dc9c9089a9dp-1,
  0x1.f38f3ac64e589p-1,
  0x1.f43d085ff92ddp-1,
  0x1.f4e603b0b2f2dp-1,
  0x1.f58a2b1789e84p-1,
  0x1.f6297cff75cbp-1,
  0x1.f6c3f7df5bbb7p-1,
  0x1.f7599a3a12077p-1,
  0x1.f7ea629e63d6ep-1,
  0x1.f8764fa714ba9p-1,
  0x1.f8fd5ffae41dbp-1,
  0x1.f97f924c9099bp-1,
  0x1.f9fce55adb2c8p-1,
  0x1.fa7557f08a517p-1,
  0x1.fae8e8e46cfbbp-1,
  0x1.fb5797195d741p-1,
  0x1.fbc1617e44186p-1,
  0x1.fc26470e19fd3p-1,
  0x1.fc8646cfeb721p-1,
  0x1.fce15fd6da67bp-1,
  0x1.fd37914220b84p-1,
  0x1.fd88da3d12526p-1,
  0x1.fdd539ff1f456p-1,
  0x1.fe1cafcbd5b09p-1,
  0x1.fe5f3af2e394p-1,
  0x1.fe9cdad01883ap-1,
  0x1.fed58ecb673c4p-1,
  0x1.ff095658e71adp-1,
  0x1.ff3830f8d575cp-1,
  0x1.ff621e3796d7ep-1,
  0x1.ff871dadb81dfp-1,
  0x1.ffa72effef75dp-1,
  0x1.ffc251df1d3f8p-1,
  0x1.ffd886084cd0dp-1,
  0x1.ffe9cb44b51a1p-1,
  0x1.fff62169b92dbp-1,
  0x1.fffd8858e8a92p-1
};

static const double cospiMBy512[256] = {
  0x1p+0,
  0x1.fffd8858e8a92p-1,
  0x1.fff62169b92dbp-1,
  0x1.ffe9cb44b51a1p-1,
  0x1.ffd886084cd0dp-1,
  0x1.ffc251df1d3f8p-1,
  0x1.ffa72effef75dp-1,
  0x1.ff871dadb81dfp-1,
  0x1.ff621e3796d7ep-1,
  0x1.ff3830f8d575cp-1,
  0x1.ff095658e71adp-1,
  0x1.fed58ecb673c4p-1,
  0x1.fe9cdad01883ap-1,
  0x1.fe5f3af2e394p-1,
  0x1.fe1cafcbd5b09p-1,
  0x1.fdd539ff1f456p-1,
  0x1.fd88da3d12526p-1,
  0x1.fd37914220b84p-1,
  0x1.fce15fd6da67bp-1,
  0x1.fc8646cfeb721p-1,
  0x1.fc26470e19fd3p-1,
  0x1.fbc1617e44186p-1,
  0x1.fb5797195d741p-1,
  0x1.fae8e8e46cfbbp-1,
  0x1.fa7557f08a517p-1,
  0x1.f9fce55adb2c8p-1,
  0x1.f97f924c9099bp-1,
  0x1.f8fd5ffae41dbp-1,
  0x1.f8764fa714ba9p-1,
  0x1.f7ea629e63d6ep-1,
  0x1.f7599a3a12077p-1,
  0x1.f6c3f7df5bbb7p-1,
  0x1.f6297cff75cbp-1,
  0x1.f58a2b1789e84p-1,
  0x1.f4e603b0b2f2dp-1,
  0x1.f43d085ff92ddp-1,
  0x1.f38f3ac64e589p-1,
  0x1.f2dc9c9089a9dp-1,
  0x1.f2252f7763adap-1,
  0x1.f168f53f7205dp-1,
  0x1.f0a7efb9230d7p-1,
  0x1.efe220c0b95ecp-1,
  0x1.ef178a3e473c2p-1,
  0x1.ee482e25a9dbcp-1,
  0x1.ed740e7684963p-1,
  0x1.ec9b2d3c3bf84p-1,
  0x1.ebbd8c8df0b74p-1,
  0x1.eadb2e8e7a88ep-1,
  0x1.e9f4156c62ddap-1,
  0x1.e9084361df7f2p-1,
  0x1.e817bab4cd10dp-1,
  0x1.e7227db6a9744p-1,
  0x1.e6288ec48e112p-1,
  0x1.e529f04729ffcp-1,
  0x1.e426a4b2bc17ep-1,
  0x1.e31eae870ce25p-1,
  0x1.e212104f686e5p-1,
  0x1.e100cca2980acp-1,
  0x1.dfeae622dbe2bp-1,
  0x1.ded05f7de47dap-1,
  0x1.ddb13b6ccc23cp-1,
  0x1.dc8d7cb41026p-1,
  0x1.db6526238a09bp-1,
  0x1.da383a9668988p-1,
  0x1.d906bcf328d46p-1,
  0x1.d7d0b02b8ecf9p-1,
  0x1.d696173c9e68bp-1,
  0x1.d556f52e93eb1p-1,
  0x1.d4134d14dc93ap-1,
  0x1.d2cb220e0ef9fp-1,
  0x1.d17e7743e35dcp-1,
  0x1.d02d4feb2bd92p-1,
  0x1.ced7af43cc773p-1,
  0x1.cd7d9898b32f6p-1,
  0x1.cc1f0f3fcfc5cp-1,
  0x1.cabc169a0b9p-1,
  0x1.c954b213411f5p-1,
  0x1.c7e8e52233cf3p-1,
  0x1.c678b3488739bp-1,
  0x1.c5042012b6907p-1,
  0x1.c38b2f180bdb1p-1,
  0x1.c20de3fa971bp-1,
  0x1.c08c426725549p-1,
  0x1.bf064e15377ddp-1,
  0x1.bd7c0ac6f952ap-1,
  0x1.bbed7c49380eap-1,
  0x1.ba5aa673590d2p-1,
  0x1.b8c38d27504e9p-1,
  0x1.b728345196e3ep-1,
  0x1.b5889fe921405p-1,
  0x1.b3e4d3ef55712p-1,
  0x1.b23cd470013b4p-1,
  0x1.b090a581502p-1,
  0x1.aee04b43c1474p-1,
  0x1.ad2bc9e21d511p-1,
  0x1.ab7325916c0d4p-1,
  0x1.a9b66290ea1a3p-1,
  0x1.a7f58529fe69dp-1,
  0x1.a63091b02fae2p-1,
  0x1.a4678c8119ac8p-1,
  0x1.a29a7a0462782p-1,
  0x1.a0c95eabaf937p-1,
  0x1.9ef43ef29af94p-1,
  0x1.9d1b1f5ea80d5p-1,
  0x1.9b3e047f38741p-1,
  0x1.995cf2ed80d22p-1,
  0x1.9777ef4c7d742p-1,
  0x1.958efe48e6dd7p-1,
  0x1.93a22499263fbp-1,
  0x1.91b166fd49da2p-1,
  0x1.8fbcca3ef940dp-1,
  0x1.8dc45331698ccp-1,
  0x1.8bc806b151741p-1,
  0x1.89c7e9a4dd4aap-1,
  0x1.87c400fba2ebfp-1,
  0x1.85bc51ae958ccp-1,
  0x1.83b0e0bff976ep-1,
  0x1.81a1b33b57accp-1,
  0x1.7f8ece3571771p-1,
  0x1.7d7836cc33db2p-1,
  0x1.7b5df226aafafp-1,
  0x1.79400574f55e5p-1,
  0x1.771e75f037261p-1,
  0x1.74f948da8d28dp-1,
  0x1.72d0837efff96p-1,
  0x1.70a42b3176d7ap-1,
  0x1.6e74454eaa8afp-1,
  0x1.6c40d73c18275p-1,
  0x1.6a09e667f3bcdp-1,
  0x1.67cf78491af1p-1,
  0x1.6591925f0783dp-1,
  0x1.63503a31c1be9p-1,
  0x1.610b7551d2cdfp-1,
  0x1.5ec3495837074p-1,
  0x1.5c77bbe65018cp-1,
  0x1.5a28d2a5d725p-1,
  0x1.57d69348cecap-1,
  0x1.5581038975137p-1,
  0x1.5328292a35596p-1,
  0x1.50cc09f59a09bp-1,
  0x1.4e6cabbe3e5e9p-1,
  0x1.4c0a145ec0004p-1,
  0x1.49a449b9b0939p-1,
  0x1.473b51b987347p-1,
  0x1.44cf325091dd6p-1,
  0x1.425ff178e6bb1p-1,
  0x1.3fed9534556d4p-1,
  0x1.3d78238c58344p-1,
  0x1.3affa292050b9p-1,
  0x1.3884185dfeb22p-1,
  0x1.36058b10659f3p-1,
  0x1.338400d0c8e57p-1,
  0x1.30ff7fce17035p-1,
  0x1.2e780e3e8ea17p-1,
  0x1.2bedb25faf3eap-1,
  0x1.2960727629ca8p-1,
  0x1.26d054cdd12dfp-1,
  0x1.243d5fb98ac1fp-1,
  0x1.21a799933eb59p-1,
  0x1.1f0f08bbc861bp-1,
  0x1.1c73b39ae68c8p-1,
  0x1.19d5a09f2b9b8p-1,
  0x1.1734d63dedb49p-1,
  0x1.14915af336cebp-1,
  0x1.11eb3541b4b23p-1,
  0x1.0f426bb2a8e7ep-1,
  0x1.0c9704d5d898fp-1,
  0x1.09e907417c5e1p-1,
  0x1.073879922ffeep-1,
  0x1.0485626ae221ap-1,
  0x1.01cfc874c3eb7p-1,
  0x1.fe2f64be7121p-2,
  0x1.f8ba4dbf89abap-2,
  0x1.f3405963fd067p-2,
  0x1.edc1952ef78d6p-2,
  0x1.e83e0eaf85114p-2,
  0x1.e2b5d3806f63bp-2,
  0x1.dd28f1481cc58p-2,
  0x1.d79775b86e389p-2,
  0x1.d2016e8e9db5bp-2,
  0x1.cc66e9931c45ep-2,
  0x1.c6c7f4997000bp-2,
  0x1.c1249d8011ee7p-2,
  0x1.bb7cf2304bd01p-2,
  0x1.b5d1009e15ccp-2,
  0x1.b020d6c7f4009p-2,
  0x1.aa6c82b6d3fcap-2,
  0x1.a4b4127dea1e5p-2,
  0x1.9ef7943a8ed8ap-2,
  0x1.993716141bdffp-2,
  0x1.9372a63bc93d7p-2,
  0x1.8daa52ec8a4bp-2,
  0x1.87de2a6aea963p-2,
  0x1.820e3b04eaac4p-2,
  0x1.7c3a9311dcce7p-2,
  0x1.766340f2418f6p-2,
  0x1.7088530fa459fp-2,
  0x1.6aa9d7dc77e17p-2,
  0x1.64c7ddd3f27c6p-2,
  0x1.5ee27379ea693p-2,
  0x1.58f9a75ab1fddp-2,
  0x1.530d880af3c24p-2,
  0x1.4d1e24278e76ap-2,
  0x1.472b8a5571054p-2,
  0x1.4135c94176601p-2,
  0x1.3b3cefa0414b7p-2,
  0x1.35410c2e18152p-2,
  0x1.2f422daec0387p-2,
  0x1.294062ed59f06p-2,
  0x1.233bbabc3bb71p-2,
  0x1.1d3443f4cdb3ep-2,
  0x1.172a0d7765177p-2,
  0x1.111d262b1f677p-2,
  0x1.0b0d9cfdbdb9p-2,
  0x1.04fb80e37fdaep-2,
  0x1.fdcdc1adfedf9p-3,
  0x1.f19f97b215f1bp-3,
  0x1.e56ca1e101a1bp-3,
  0x1.d934fe5454311p-3,
  0x1.ccf8cb312b286p-3,
  0x1.c0b826a7e4f63p-3,
  0x1.b4732ef3d6722p-3,
  0x1.a82a025b00451p-3,
  0x1.9bdcbf2dc4366p-3,
  0x1.8f8b83c69a60bp-3,
  0x1.83366e89c64c6p-3,
  0x1.76dd9de50bf31p-3,
  0x1.6a81304f64ab2p-3,
  0x1.5e214448b3fc6p-3,
  0x1.51bdf8597c5f2p-3,
  0x1.45576b1293e5ap-3,
  0x1.38edbb0cd8d14p-3,
  0x1.2c8106e8e613ap-3,
  0x1.20116d4ec7bcfp-3,
  0x1.139f0cedaf577p-3,
  0x1.072a047ba831dp-3,
  0x1.f564e56a9730ep-4,
  0x1.dc70ecbae9fc9p-4,
  0x1.c3785c79ec2d5p-4,
  0x1.aa7b724495c03p-4,
  0x1.917a6bc29b42cp-4,
  0x1.787586a5d5b21p-4,
  0x1.5f6d00a9aa419p-4,
  0x1.4661179272096p-4,
  0x1.2d52092ce19f6p-4,
  0x1.1440134d709b3p-4,
  0x1.f656e79f820ep-5,
  0x1.c428d12c0d7e3p-5,
  0x1.91f65f10dd814p-5,
  0x1.5fc00d290cd43p-5,
  0x1.2d865759455cdp-5,
  0x1.f693731d1cf01p-6,
  0x1.92155f7a3667ep-6,
  0x1.2d936bbe30efdp-6,
  0x1.921d1fcdec784p-7,
  0x1.921f0fe670071p-8
};

#endif
